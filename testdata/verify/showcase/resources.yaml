apiVersion: v1
kind: ServiceAccount
metadata:
  name: demo-sa
  namespace: ktl-verify-showcase
automountServiceAccountToken: true
---
apiVersion: v1
kind: Pod
metadata:
  name: critical-hostns
  namespace: ktl-verify-showcase
  labels:
    app: verify-demo
spec:
  serviceAccountName: demo-sa
  # Intentionally unsafe: triggers the showcase CRITICAL rule.
  hostNetwork: true
  hostPID: true
  containers:
    - name: app
      image: busybox:1.36
      command: ["sh", "-c", "sleep 3600"]
      # Intentionally unsafe: triggers builtin HIGH + MEDIUM/LOW rules.
      securityContext:
        privileged: true
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: no-mem-limits
  namespace: ktl-verify-showcase
spec:
  replicas: 1
  selector:
    matchLabels:
      app: no-mem-limits
  template:
    metadata:
      labels:
        app: no-mem-limits
    spec:
      containers:
        - name: app
          image: nginx:1.27
          # Intentionally missing resources.limits.memory (triggers builtin MEDIUM).
          resources:
            requests:
              memory: 32Mi
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: no-drop-capabilities
  namespace: ktl-verify-showcase
spec:
  selector:
    matchLabels:
      app: no-drop-capabilities
  template:
    metadata:
      labels:
        app: no-drop-capabilities
    spec:
      containers:
        - name: app
          image: busybox:1.36
          command: ["sh", "-c", "sleep 3600"]
          # Intentionally no capabilities.drop and no securityContext (triggers builtin MEDIUM + LOW).

