version: v1
rules:
  - id: arg_name_suspicious
    severity: warn
    applies_to: [build_arg_name]
    regex: '(?i)(token|secret|password|passwd|api[_-]?key|auth|private[_-]?key|github[_-]?token|npm[_-]?token|pypi[_-]?token|aws[_-]?secret|gcp[_-]?key|docker[_-]?password)|(_TOKEN|_SECRET|_PASSWORD)$'
    message: build-arg name looks like a secret; prefer BuildKit secrets instead of --build-arg
    suggestion: Use `--secret <NAME>` and mount it via BuildKit instead of passing it as a build arg.
  - id: private_key
    severity: block
    applies_to: [build_arg_value, oci_content, log_line]
    regex: '-----BEGIN ([A-Z ]+ )?PRIVATE KEY-----'
    message: private key material detected
  - id: github_token
    severity: warn
    applies_to: [build_arg_value, oci_content, log_line]
    regex: '\b(ghp|gho|ghu|ghs|ghr)_[A-Za-z0-9]{20,}\b'
    message: GitHub token-like string detected

