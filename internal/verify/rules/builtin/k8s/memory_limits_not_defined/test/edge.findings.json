[
  {
    "ruleId": "k8s/memory_limits_not_defined",
    "severity": "medium",
    "category": "Resource Management",
    "message": "Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory",
    "fieldPath": "spec.containers.0.resources.limits",
    "location": "metadata.name={{memory-demo-1}}.spec.containers.name={{memory-demo-ctr}}",
    "resourceKey": "mem-example/Pod/memory-demo-1",
    "expected": "metadata.name={{memory-demo-1}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory should be defined",
    "observed": "metadata.name={{memory-demo-1}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory is undefined",
    "subject": {
      "kind": "Pod",
      "namespace": "mem-example",
      "name": "memory-demo-1"
    },
    "fingerprint": "k8s/memory_limits_not_defined:mem-example/Pod/memory-demo-1:metadata.name={{memory-demo-1}}.spec.containers.name={{memory-demo-ctr}}",
    "helpUrl": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
    "evidence": {
      "containers": [
        {
          "image": "polinux/stress",
          "name": "memory-demo-ctr"
        }
      ],
      "fieldPath": "spec.containers.0.resources.limits",
      "kind": "Pod",
      "name": "memory-demo-1",
      "namespace": "mem-example"
    }
  },
  {
    "ruleId": "k8s/memory_limits_not_defined",
    "severity": "medium",
    "category": "Resource Management",
    "message": "Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory",
    "fieldPath": "spec.containers.0.resources.limits",
    "location": "metadata.name={{memory-demo-2}}.spec.containers.name={{memory-demo-ctr}}",
    "resourceKey": "mem-example/Pod/memory-demo-2",
    "expected": "metadata.name={{memory-demo-2}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory should be defined",
    "observed": "metadata.name={{memory-demo-2}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory is undefined",
    "subject": {
      "kind": "Pod",
      "namespace": "mem-example",
      "name": "memory-demo-2"
    },
    "fingerprint": "k8s/memory_limits_not_defined:mem-example/Pod/memory-demo-2:metadata.name={{memory-demo-2}}.spec.containers.name={{memory-demo-ctr}}",
    "helpUrl": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
    "evidence": {
      "containers": [
        {
          "image": "polinux/stress",
          "name": "memory-demo-ctr"
        }
      ],
      "fieldPath": "spec.containers.0.resources.limits",
      "kind": "Pod",
      "name": "memory-demo-2",
      "namespace": "mem-example"
    }
  },
  {
    "ruleId": "k8s/memory_limits_not_defined",
    "severity": "medium",
    "category": "Resource Management",
    "message": "Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory",
    "fieldPath": "spec.containers.0.resources.limits",
    "location": "metadata.name={{memory-demo-3}}.spec.containers.name={{memory-demo-ctr}}",
    "resourceKey": "mem-example/Pod/memory-demo-3",
    "expected": "metadata.name={{memory-demo-3}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory should be defined",
    "observed": "metadata.name={{memory-demo-3}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory is undefined",
    "subject": {
      "kind": "Pod",
      "namespace": "mem-example",
      "name": "memory-demo-3"
    },
    "fingerprint": "k8s/memory_limits_not_defined:mem-example/Pod/memory-demo-3:metadata.name={{memory-demo-3}}.spec.containers.name={{memory-demo-ctr}}",
    "helpUrl": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
    "evidence": {
      "containers": [
        {
          "image": "polinux/stress",
          "name": "memory-demo-ctr"
        }
      ],
      "fieldPath": "spec.containers.0.resources.limits",
      "kind": "Pod",
      "name": "memory-demo-3",
      "namespace": "mem-example"
    }
  },
  {
    "ruleId": "k8s/memory_limits_not_defined",
    "severity": "medium",
    "category": "Resource Management",
    "message": "Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory",
    "fieldPath": "spec.containers.0.resources.limits",
    "location": "metadata.name={{memory-demo-4}}.spec.containers.name={{memory-demo-ctr}}",
    "resourceKey": "mem-example/Pod/memory-demo-4",
    "expected": "metadata.name={{memory-demo-4}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory should be defined",
    "observed": "metadata.name={{memory-demo-4}}.spec.containers.name={{memory-demo-ctr}}.resources.limits.memory is undefined",
    "subject": {
      "kind": "Pod",
      "namespace": "mem-example",
      "name": "memory-demo-4"
    },
    "fingerprint": "k8s/memory_limits_not_defined:mem-example/Pod/memory-demo-4:metadata.name={{memory-demo-4}}.spec.containers.name={{memory-demo-ctr}}",
    "helpUrl": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/",
    "evidence": {
      "containers": [
        {
          "image": "polinux/stress",
          "name": "memory-demo-ctr"
        }
      ],
      "fieldPath": "spec.containers.0.resources.limits",
      "kind": "Pod",
      "name": "memory-demo-4",
      "namespace": "mem-example"
    }
  }
]
