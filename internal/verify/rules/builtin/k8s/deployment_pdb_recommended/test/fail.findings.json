[
  {
    "ruleId": "k8s/deployment_pdb_recommended",
    "severity": "info",
    "category": "Availability",
    "message": "Deployments with 3 or more replicas should consider a PodDisruptionBudget. This rule only checks within the same manifest render.",
    "fieldPath": "spec.selector.matchLabels",
    "location": "metadata.name={{web}}.spec.selector.matchLabels",
    "resourceKey": "default/Deployment/web",
    "expected": "metadata.name={{web}} should have a matching PodDisruptionBudget",
    "observed": "metadata.name={{web}} has 3+ replicas without a matching PDB in this render",
    "subject": {
      "kind": "Deployment",
      "namespace": "default",
      "name": "web"
    },
    "fingerprint": "k8s/deployment_pdb_recommended:default/Deployment/web:metadata.name={{web}}.spec.selector.matchLabels",
    "helpUrl": "https://kubernetes.io/docs/tasks/run-application/configure-pdb/",
    "evidence": {
      "containers": [
        {
          "image": "nginx:1.25",
          "name": "app"
        }
      ],
      "fieldPath": "spec.selector.matchLabels",
      "kind": "Deployment",
      "name": "web",
      "namespace": "default"
    }
  }
]
